function toggleEpisodeDetails(){$("#episode_details_div").toggle(),$("#details_caret").toggleClass("fa-caret-down"),$("#details_caret").toggleClass("fa-caret-up")}function confirmclassviewmyremove(class_id){if(ok=confirm("Are you sure you want to remove this class from your classes taken list?"),ok){var url="/classes/viewed.cfm?action=my_remove&class_id="+class_id;$.ajax({type:"GET",url:url,data:"",async:!1,success:function(html){$("#viewed_status").html(html)}})}}function confirmclassaddviewed(class_id){if(ok=confirm("Are you sure you want to show this class as already viewed?"),ok){var url="/classes/viewed.cfm?action=my_add&class_id="+class_id;$.ajax({type:"GET",url:url,data:"",async:!1,success:function(html){$("#viewed_status").html(html)}})}}function toggleDescs(mycount){return $("#short_desc_"+mycount).toggle(),$("#long_desc_"+mycount).toggle(),!1}function loadThisSearch(){customer_search_id=$("#customer_search_id").val(),new_url="/classes.cfm?load_saved_search=true&customer_search_id="+customer_search_id,self.location=new_url}function mark_all_as_viewed(){$.ajax({type:"GET",url:"/functions/ajax/alerts.cfm",data:{action:"mark_all_as_viewed"},success:function(){$("li[name='alert_item']").switchClass("alert-unread","alert-read"),$(".js-new-alerts-indicator").hide(500)}})}$(".js-queue-button").click(function(){queue_button=$(this),my_class_id=queue_button.attr("data-class-id"),i_queue=queue_button.attr("data-i-queue");var queue_error=!1;if(timeshift_media.logged_in)if("true"==i_queue){if(ok=confirm("Are you sure you want to remove this video from your queue?"),ok){queue_button.html("Removing...");var url="/classes/playlists_ajax.cfm?action=rem&my_class_id="+my_class_id+"&my_playlist_type=Q&my_rank=L&my_key="+pa_key+"&my_customer_id="+pa_customer_id;$.ajax({type:"GET",url:url,success:function(html){-1<html.indexOf("ERROR")?queue_error=!0:(queue_button.toggleClass("btn-primary btn-primary-ghost"),queue_button.html("<i class='far fa-plus'></i> Queue"),queue_button.attr("data-i-queue","false"),$(".pl_type_Q").toggle())},error:function(){queue_error=!0}})}}else{queue_button.html("Adding...");url="/classes/playlists_ajax.cfm?action=add&my_class_id="+my_class_id+"&my_playlist_type=Q&my_rank=L&my_key="+pa_key+"&my_customer_id="+pa_customer_id;$.ajax({type:"GET",url:url,success:function(html){-1<html.indexOf("ERROR")?queue_error=!0:(queue_button.toggleClass("btn-primary btn-primary-ghost"),queue_button.html("<i class='far fa-plus'></i> In Queue"),queue_button.attr("data-i-queue","true"),new_html=$("#added_playlists_space").html()+html,$("#added_playlists_space").show(),$("#added_playlists_space").html(new_html))},error:function(){queue_error=!0}})}else $("#accountNeededModal").modal();queue_error&&alert("There was an eror. Please try refreshing the page and trying again.")}),$("#js-like-button").click(function(){like_button=$(this),my_class_id=like_button.attr("data-class-id"),i_like=like_button.attr("data-i-like"),timeshift_media.logged_in?"true"==i_like?(ok=confirm("Are you sure you want to remove your like?"),ok&&(liked("class_likes",my_class_id,"RemoveLike"),like_button.toggleClass("btn-primary btn-primary-ghost"),like_button.html("<i class='far fa-thumbs-up'></i> Like"),like_button.attr("data-i-like","false"))):(liked("class_likes",my_class_id,"Y"),like_button.toggleClass("btn-primary btn-primary-ghost"),like_button.html("<i class='far fa-thumbs-up'></i> Liked"),like_button.attr("data-i-like","true")):$("#accountNeededModal").modal()}),$("#js-fav-button").click(function(){my_class_id=$(this).attr("data-class-id"),i_fav=$(this).attr("data-i-fav");var fav_error=!1;if(timeshift_media.logged_in)if("true"==i_fav){if(ok=confirm("Are you sure you want to remove this video from your favorites list?"),ok){$("#js-fav-button-text").html("Removing...");var url="/classes/playlists_ajax.cfm?action=rem&my_class_id="+my_class_id+"&my_playlist_type=F&my_rank=F&my_key="+pa_key+"&my_customer_id="+pa_customer_id;$.ajax({type:"GET",url:url,success:function(html){-1<html.indexOf("ERROR")?fav_error=!0:($("#js-fav-button").toggleClass("btn-primary btn-primary-ghost"),$("#js-fav-button-text").html("Favorite"),$(this).attr("js-i-fav","false"),$(".pl_type_F").toggle())},error:function(){fav_error=!0}})}}else{$("#js-fav-button-text").html("Adding...");url="/classes/playlists_ajax.cfm?action=add&my_class_id="+my_class_id+"&my_playlist_type=F&my_rank=F&my_key="+pa_key+"&my_customer_id="+pa_customer_id;$.ajax({type:"GET",url:url,success:function(html){-1<html.indexOf("ERROR")?fav_error=!0:($("#js-fav-button").toggleClass("btn-primary btn-primary-ghost"),$("#js-fav-button-text").html("In Favorites"),$(this).attr("js-i-fav","true"),new_html=$("#added_playlists_space").html()+html,$("#added_playlists_space").show(),$("#added_playlists_space").html(new_html))},error:function(){fav_error=!0}})}else $("#accountNeededModal").modal();fav_error&&alert("There was an eror. Please try refreshing the page and trying again.")}),$("[data-cancel-link]").on("click",function(){var url="/account/my_account.cfm?action=cancel_account_modal";"mobile"==timeshift_media.display_type?location=url:show_modal_iframe("I",url)}),function($){var proto=$.ui.autocomplete.prototype,initSource=proto._initSource;$.extend(proto,{_initSource:function(){this.options.html&&$.isArray(this.options.source)?this.source=function(request,response){response(filter(this.options.source,request.term))}:initSource.call(this)},_renderItem:function(ul,item){return $("<li></li>").data("item.autocomplete",item).append($("<a>").html(item.label)).appendTo(ul)}})}(jQuery),$("[data-challenge-playlist-id]").click(function(){url="/shows/challenge_start.cfm?playlist_id="+$(this).attr("data-challenge-playlist-id"),"desktop"==timeshift_media.display_type?show_modal_iframe("I",url):show_modal_iframe("90%",url)}),$(".js-custom-days").click(function(){is_custom_date=$("input[name=custom_days]:checked").val(),1==is_custom_date?$("#js-day-select-div").show(250):$("#js-day-select-div").hide(250)}),$("#tm-play-pause-button").click(function(){$("#tm-play-pause-icon").hasClass("fa-play")?$("#tm-play-pause-text").html("Pause"):$("#tm-play-pause-text").html("Play"),$("#tm-play-pause-icon").toggleClass("fa-play fa-pause")}),$("[data-who-likes-id]").click(function(){url="/classes/who_likes.cfm?class_id="+$(this).attr("data-who-likes-id"),"desktop"==timeshift_media.display_type?show_modal_iframe("A",url):show_modal_iframe("90%",url)}),$("#js-show-all-chapters-button").click(function(){$("#js-show-all-chapters-arrow").toggleClass("fa-chevron-down fa-chevron-up"),$("#js-show-all-chapters-text-more").toggleClass("hidden"),$("#js-show-all-chapters-text-less").toggleClass("hidden")}),$("#js-show-exercises").click(function(){$("#js-class-notes-xs").toggleClass("hidden-xs"),$("#js-show-exercises-icon").toggleClass("fa-chevron-down fa-chevron-up")}),$("[data-chapter-start-secs]").click(function(){this_secs=$(this).attr("data-chapter-start-secs"),seek(this_secs)}),toggleTabCollapse=function(){$("#js-collapse-class-tabs-icon").toggleClass("fa-chevron-double-right fa-chevron-double-left"),$("#js-class-tabs").toggleClass("hidden-lg hidden-md"),$("#js-class-player").toggleClass("col-lg-8 col-md-7 col-lg-12"),$(".js-class-tab-button-side").toggle()},$("#js-collapse-class-tabs").click(function(){toggleTabCollapse()}),$(".js-uncollapse-tab").click(function(){tab_id=$(this).attr("data-tab-id"),toggleTabCollapse(),$('.nav-tabs a[href="#'+tab_id+'"]').tab("show")}),$(".btn").mouseup(function(){$(this).blur()}),refreshCustomerNotes=function(class_id){var url="/classes/customer_notes_ajax.cfm?action=refresh&my_class_id="+class_id;$.ajax({type:"GET",url:url,data:"",async:!1,success:function(html){$("#js-customer-class-notes-current").html(html)}})},deleteCustomerNote=function(note_id){var url="/classes/customer_notes_ajax.cfm?action=delete&my_note_id="+note_id;$.getJSON(url,function(jsonresult){jsonresult.ERROR||$("#js-customer-note-"+note_id).hide(500)})},saveEditCustomerNote=function(note_id){$("#js-add-note-error").fadeOut(200),note_text=$("#js-note-edit-textarea-"+note_id).val(),class_id=$("#js-customer-note-add").attr("data-class-id");var url="/classes/customer_notes_ajax.cfm?action=save_edit&my_note_id="+note_id+"&my_class_id="+class_id+"&my_note="+encodeURIComponent(note_text);$.post(url,function(jsonresult){jsonresult.ERROR?($("#js-add-note-error").html(jsonresult.ERROR_MESSAGE),$("#js-add-note-error").fadeIn(200)):refreshCustomerNotes(class_id)})},editCustomerNote=function(note_id){$("#js-add-note-error").fadeOut(200),$("#js-note-text-"+note_id).hide(),$("#js-note-edit-"+note_id).show(),$("#js-note-edit-textarea-"+note_id).focus()},cancelEditCustomerNote=function(note_id){$("#js-add-note-error").fadeOut(200),$("#js-note-text-"+note_id).show(),$("#js-note-edit-"+note_id).hide()},$("#js-customer-note-text").focus(function(){$("#js-add-note-error").fadeOut(200)}),$("#js-customer-note-add").click(function(){$("#js-add-note-error").fadeOut(200),note_text=$("#js-customer-note-text").val(),class_id=$(this).attr("data-class-id");var url="/classes/customer_notes_ajax.cfm?action=add&my_class_id="+class_id+"&my_note="+encodeURIComponent(note_text);$.post(url,function(jsonresult){jsonresult.ERROR?($("#js-add-note-error").html(jsonresult.ERROR_MESSAGE),$("#js-add-note-error").fadeIn(200)):($("#js-customer-note-text").val(""),refreshCustomerNotes(class_id))})}),$("#js-customer-note-text").on("keyup",function(event){if(13==event.keyCode){$("#js-add-note-error").fadeOut(200),note_text=$("#js-customer-note-text").val(),class_id=$("#js-customer-note-add").attr("data-class-id");var url="/classes/customer_notes_ajax.cfm?action=add&my_class_id="+class_id+"&my_note="+encodeURIComponent(note_text);$.getJSON(url,function(jsonresult){jsonresult.ERROR?($("#js-add-note-error").html(jsonresult.ERROR_MESSAGE),$("#js-add-note-error").fadeIn(200)):($("#js-customer-note-text").val(""),refreshCustomerNotes(class_id))})}}),scrollToChapter=function(my_chapter){var element,to,duration,start,change,currentTime,animateScroll,topPos=document.getElementById("js-chapter-"+my_chapter).offsetTop;Math.easeInOutQuad=function(t,b,c,d){return(t/=d/2)<1?c/2*t*t+b:-c/2*(--t*(t-2)-1)+b},element=document.getElementById("js-chapters-tabpanel"),to=topPos-60,duration=600,start=element.scrollTop,change=to-start,currentTime=0,(animateScroll=function(){currentTime+=20;var val=Math.easeInOutQuad(currentTime,start,change,duration);element.scrollTop=val,currentTime<duration&&setTimeout(animateScroll,20)})()},scrollToClassNote=function(my_class_note_id){var element,to,duration,start,change,currentTime,animateScroll,topPos=document.getElementById("js-class-note-id-"+my_class_note_id).offsetTop;Math.easeInOutQuad=function(t,b,c,d){return(t/=d/2)<1?c/2*t*t+b:-c/2*(--t*(t-2)-1)+b},element=document.getElementById("js-class-notes-tabpanel"),to=topPos-60,duration=600,start=element.scrollTop,change=to-start,currentTime=0,(animateScroll=function(){currentTime+=20;var val=Math.easeInOutQuad(currentTime,start,change,duration);element.scrollTop=val,currentTime<duration&&setTimeout(animateScroll,20)})()},priorPositionFound=-1,scrollToTranscriptSegment=function(my_position){var element,to,duration,start,change,currentTime,animateScroll,elem=document.getElementById("js-t-p-"+my_position);if(null!=elem){var elem_jq=$("#js-t-p-"+my_position);if(!elem_jq.hasClass("tm-t-h")){elem_jq.addClass("tm-t-h");var prior_elem_jq=$("#js-t-p-"+priorPositionFound);prior_elem_jq.hasClass("tm-t-h")&&prior_elem_jq.removeClass("tm-t-h"),priorPositionFound=my_position}var topPos=elem.offsetTop;Math.easeInOutQuad=function(t,b,c,d){return(t/=d/2)<1?c/2*t*t+b:-c/2*(--t*(t-2)-1)+b};var myTabpanel=document.getElementById("js-transcript-tabpanel"),myTabpanelTop=myTabpanel.scrollTop,targetPos=topPos-100;(100<targetPos-myTabpanelTop||100<myTabpanelTop-targetPos)&&(to=targetPos,duration=600,start=(element=myTabpanel).scrollTop,change=to-start,currentTime=0,(animateScroll=function(){currentTime+=100;var val=Math.easeInOutQuad(currentTime,start,change,duration);element.scrollTop=val,currentTime<duration&&setTimeout(animateScroll,100)})())}},timeshift_media.comments={},timeshift_media.comments.mentioned_customer_ids=[],timeshift_media.comments.forum_id=$("#forum_id").val(),timeshift_media.comments.thread_id=void 0===$("#thread_id").val()?null:$("#thread_id").val(),timeshift_media.comments.add_follow=function(){$.ajax({type:"GET",url:"/functions/ajax/threads.cfm",data:{action:"add_thread_follow",thread_id:timeshift_media.comments.thread_id},success:function(){$("#js-add-follow-div").html("<b>You are now following this thread.</b> <a target='_top' href='javascript:timeshift_media.comments.stop_follow();'>Stop Following</a>")}})},timeshift_media.comments.find_profile_names=function(words){var found_names=[];return $.each(timeshift_media.comments.customers,function(index,value){value.toLowerCase().startsWith(words)&&found_names.push(value)}),found_names},timeshift_media.comments.lastWord=function(phrase){var words=phrase.replace(/[.,\/#!$%\^&\*;:{}=\-_`~()]/g," ").split(/\s+/),last_words=words.pop();return last_words.length<2&&1<words.length&&(last_words=words.pop()+" "+last_words),last_words},timeshift_media.comments.show_customer_menu=function(){timeshift_media.comments.keyboard_select=!1,$("#comment").autocomplete("option","minLength",0),$("#comment").autocomplete("search",""),$("#comment").autocomplete("option","minLength",2)},timeshift_media.comments.show_mentioned=function(){var profile_name,mentioned_customers="",comment=timeshift_media.comments.new_comment.toLowerCase();$.each(timeshift_media.comments.customers,function(index,value){profile_name=value.toLowerCase(),0<comment.indexOf(profile_name)&&(0<mentioned_customers.length&&(mentioned_customers+=", "),mentioned_customers+=value)}),0==mentioned_customers.length?$("#mentions").hide():($("#mentions").show(),$("#mentions").text("Mentioned members: "+mentioned_customers))},timeshift_media.comments.stop_follow=function(){$.ajax({type:"GET",url:"/functions/ajax/threads.cfm",data:{action:"remove_thread_follow",thread_id:timeshift_media.comments.thread_id},success:function(){$("#js-add-follow-div").html("<b>You are no longer following this thread.</b> <a target='_top' href='javascript:timeshift_media.comments.add_follow();'>Start Following Again</a>")}})},$("#comment_disabled").keyup(function(event){this.value;timeshift_media.comments.new_comment=this.value,timeshift_media.comments.keyboard_select=!0,event.keyCode===$.ui.keyCode.TAB&&$(this).autocomplete("instance").menu.active&&event.preventDefault()}).autocomplete({minLength:2,source:function(request,response){var array,term,matcher;response((array=timeshift_media.comments.profile_names,term=lastWord(request.term),matcher=new RegExp("^"+$.ui.autocomplete.escapeRegex(term),"i"),$.grep(array,function(value){return matcher.test($("<div>").html(value.value).text())})))},focus:function(){return!1},select:function(event,ui){var words=this.value.split(/\s+/),found=(ui.item.label,/data-id=(\d*)/g.exec(ui.item.label));words.pop(),words.push("["+ui.item.value+"] "),new_value=this.value,timeshift_media.comments.keyboard_select&&(new_value=new_value.substr(0,new_value.length-lastWord(new_value).length)),this.value=new_value+"["+ui.item.value+"] ",Stretchy.resize(this);for(var mentioned_ids=""+$("#mentioned_customer_ids").val();","===mentioned_ids.charAt(0)||" "===mentioned_ids.charAt(0);)mentioned_ids=mentioned_ids.substr(1);return $("#mentioned_customer_ids").val(mentioned_ids+","+found[1]),!1},html:!0,position:{my:"left top",at:"left bottom"},delay:0}),timeshift_media.comments.thread_id&&$.ajax({type:"GET",url:"/functions/ajax/threads.cfm",data:{action:"thread_customers",thread_id:timeshift_media.comments.thread_id},success:function(data){timeshift_media.comments.customers={},timeshift_media.comments.profile_names=[];for(var d=0;d<data.customers.DATA.length;d++)timeshift_media.comments.customers[data.customers.DATA[d][0]]=data.customers.DATA[d][2].trim(),timeshift_media.comments.profile_names.push({label:"<div data-id="+data.customers.DATA[d][0]+' style="float:left;width:50px;height:50px;"><img style="border:0px solid gray;" src=https:'+data.customers.DATA[d][3]+'></div><div style="font-size:larger;height:50px;text-align:left;"><span style="vertical-align:middle;display:inline-block;line-height:normal;"> &nbsp;'+data.customers.DATA[d][2].trim()+"</span></div></div>",value:data.customers.DATA[d][2].trim()})}}),$("#js-comment-observer").on("click","[data-comment-who-likes-id]",function(){var url="/forums/comments/comment_likes.cfm?action=comment&comment_id="+$(this).data("comment-who-likes-id");show_modal_iframe("D",url)}),$("#js-audio-player").click(function(){aplayer.paused?aplayer.play():aplayer.pause()}),$("#js-audio-only").change(function(){this.checked?top.location=$(this).attr("data-url-audio"):top.location=$(this).attr("data-url-video")}),$("#js-apparatus-alert-close").click(function(){createCookie("SEEN_APP_WARNING","true",365)}),$("#closeAllTabs").click(function(){$(".js-class-search-tab").removeClass("active"),$(".tab-pane").removeClass("active"),$("#js-tab-update-row").hide()}),$("[data-toggle=tab]").click(function(event){my_tab=$(this).parent(),my_target=$(this).attr("href"),$(this).parent().hasClass("active")&&(event.stopPropagation(),$("#js-tab-update-row").hide(),$(my_target).removeClass("active"),my_tab.removeClass("active")),$(".collapse").collapse("hide")}),$(".js-sort-select").on("change",function(){$("#findingClassesModal").modal({keyboard:!1,backdrop:"static"}),top.location=this.value}),$(".js-video-search-checkbox").click(function(){$("#js-tab-update-row").show(200)}),$(".js-video-search-modal-btn").click(function(){$(this).toggleClass("btn-primary btn-default-light")}),$(".js-video-search-dropdown").click(function(event){if(event.stopPropagation(),$("#js-tab-update-row").show(200),this_pill=$(this),fieldname=this_pill.attr("data-id-name"),newvalue=this_pill.attr("data-id-value"),newvalue=""+newvalue,current_val=$('input[name="'+fieldname+'"]').val(),my_checkbox=$("#checkbox_"+fieldname+"_"+newvalue),any_checkbox=$("#checkbox_"+fieldname+"_any"),"classical_only"==fieldname&&"-1"!=newvalue){if(console.log("classical special"),"1"==newvalue)-1!=$.inArray("2",current_val.split(","))&&(console.log("special toggle"),$("#checkbox_"+fieldname+"_2").toggleClass("far fa-dot-circle"),$("#checkbox_"+fieldname+"_2").toggleClass("far fa-circle"),current_val="");if("2"==newvalue)-1!=$.inArray("1",current_val.split(","))&&(console.log("special toggle"),$("#checkbox_"+fieldname+"_1").toggleClass("far fa-dot-circle"),$("#checkbox_"+fieldname+"_1").toggleClass("far fa-circle"),current_val="")}var exists=-1!=$.inArray(newvalue,current_val.split(","));if("-1"!=newvalue){exists?newvalue=jQuery.grep(current_val.split(","),function(value){return value!=newvalue}):"-1"!=current_val&&""!=current_val&&(newvalue=current_val+","+newvalue),my_checkbox.toggleClass("far fa-dot-circle"),my_checkbox.toggleClass("far fa-circle"),""==newvalue&&(newvalue="-1"),anyvalue="-1",-1!=$.inArray(anyvalue,current_val.split(","))&&(any_checkbox.toggleClass("far fa-dot-circle"),any_checkbox.toggleClass("far fa-circle"))}else{any_checkbox.toggleClass("far fa-dot-circle"),any_checkbox.toggleClass("far fa-circle"),current_val_arr=current_val.split(",");for(var i=0;i<current_val_arr.length;i++)"-1"!=current_val_arr[i]&&(this_checkbox=$("#checkbox_"+fieldname+"_"+current_val_arr[i]),this_checkbox.toggleClass("far fa-dot-circle"),this_checkbox.toggleClass("far fa-circle"))}$('input[name="'+fieldname+'"]').val(newvalue)}),jQuery(document).ready(function($){$(".js-video-search-pill").click(function(){$("#js-tab-update-row").show(200),this_pill=$(this),fieldname=this_pill.attr("data-id-name"),newvalue=this_pill.attr("data-id-value"),newvalue=""+newvalue,current_val=$('input[name="'+fieldname+'"]').val(),my_checkbox=$("#pill_"+fieldname+"_"+newvalue);var exists=-1!=$.inArray(newvalue,current_val.split(","));"-1"!=newvalue&&(exists?newvalue=jQuery.grep(current_val.split(","),function(value){return value!=newvalue}):"-1"!=current_val&&""!=current_val&&(newvalue=current_val+","+newvalue),my_checkbox.toggleClass("active"),""==newvalue&&(newvalue="-1")),$('input[name="'+fieldname+'"]').val(newvalue)}),$('a[data-toggle="tab"]').on("shown.bs.tab",function(e){e.target,e.relatedTarget})}),$.datepicker.setDefaults($.datepicker.regional[""]),$(function(){$("#datepicker, #datepicker2, #datepicker3, #datepicker4, #datepicker5, #datepicker6, #datepicker7, #datepicker8").datepicker(),$(".js-datepicker").datepicker(),$("#datepicker, #datepicker2, #datepicker3, #datepicker4, #datepicker5, #datepicker6, #datepicker7, #datepicker8").attr("autocomplete","off"),$(".js-datepicker").attr("autocomplete","off")}),$("#search_range").change(function(){"Custom"!==$(this).find("option:selected").val()&&($("#datepicker").val(""),$("#datepicker2").val(""))}),$("#datepicker").change(function(){$("#search_range").val("Custom")}),$("#datepicker2").change(function(){$("#search_range").val("Custom")}),$(".js-faq-category").click(function(){var is_last_step=!1;$(this)[0].hasAttribute("data-faq-header-id")?(this_header_id=$(this).attr("data-faq-header-id"),"#js-faq-header-0"===this_header_id?is_last_step=!0:this_cat=$(this_header_id)):this_cat=$(this),is_last_step?(console.log("this is the last step!"),$("#js-last-step").show(200),$(".js-faq-expand").hide(),$(".tm-faq-category").removeClass("tm-faq-category-active"),$(".tm-faq-chevron").removeClass("fa-chevron-down"),$(".tm-faq-chevron").addClass("fa-chevron-up")):($("#js-last-step").hide(),this_target=this_cat.attr("data-faq-target"),this_icon=this_cat.attr("data-faq-icon"),this_cat.hasClass("tm-faq-category-active")||($(".js-faq-expand").hide(),$(".tm-faq-category").removeClass("tm-faq-category-active"),$(".tm-faq-chevron").removeClass("fa-chevron-down"),$(".tm-faq-chevron").addClass("fa-chevron-up")),this_cat.toggleClass("tm-faq-category-active"),$(this_target).toggle(),$(this_icon).toggleClass("fa-chevron-up fa-chevron-down"),console.log("doing scroll to "+this_target),console.log("offset is "+$(this_target).offset().top),scroll_target=$(this_cat).offset().top-top_menu_offset,$("html, body").animate({scrollTop:scroll_target},500))}),$("#js-index-duration").on("change",function(){console.log("duration changed to:"+this.value),"-1"==this.value||"5"==this.value?(console.log("needs to be an"),$("#js-index-a-an").html("an")):$("#js-index-a-an").html("a")}),$("#js-show-full-bio").click(function(){console.log("show/hide full bio"),$("#js-show-full-bio-arrow").toggleClass("fa-chevron-down fa-chevron-up"),$("#js-show-full-bio-text-more").toggleClass("hidden"),$("#js-show-full-bio-text-less").toggleClass("hidden"),$("#bioSummary").toggle(),$("#bioFull").toggleClass("hidden")}),function(){if(timeshift_media.logged_in){var template_url,result_json;$.ajax({type:"GET",data:{action:"current_notification"},dataType:"json",url:"/functions/ajax/notifications.cfm",success:function(result){timeshift_media.dev,result.queue_id&&("E"===result.notification_type?(template_url="/account/notifications/editorial_modal.cfm",container="#js-modal-container"):(template_url="/account/notifications/inline_notification.cfm",container="#js-inline-notification"),$(container).load(template_url+"?queue_id="+result.queue_id,function(){"E"===result.notification_type&&$("#js-notifications-modal").modal("show"),$.ajax({type:"POST",data:{action:"mark_as_displayed",queue_id:result.queue_id},url:"/functions/ajax/notifications.cfm",success:function(){timeshift_media.dev}}),$(".js-notification-button").on("click",function(el){el=this;$.ajax({type:"POST",url:"/functions/ajax/notifications.cfm",data:{action:"save_a_setting",queue_id:$(el).data("queue_id"),notification_id:$(el).data("notification_id"),setting_value:$(el).data("value")},success:function(result){result_json="object"==typeof result?result:JSON.parse(result),1===$(el).data("value")?(html=result_json.yes_message1,result_json.yes_url.length&&(html=html+' <a href="'+result_json.yes_url+'">'+result_json.yes_url_title+"</a>",html+=result_json.yes_message2)):(html=result_json.no_message1,result_json.no_url.length&&(html=html+' <a href="'+result_json.no_url+'">'+result_json.no_url_title+"</a>",html+=result_json.no_message2)),$("#notification_box").html(html)}})}),$(".js-template-link").on("click",function(el){el=this;$.ajax({type:"POST",url:"/functions/ajax/notifications.cfm",data:{action:"save_a_setting",queue_id:$(el).data("queue_id"),notification_id:$(el).data("notification_id"),setting_value:$(el).data("value")}})}),$(".js-dismiss-x").on("click",function(){$.ajax({type:"POST",url:"/functions/ajax/notifications.cfm",data:{action:"dismiss_notification",queue_id:$(this).data("queue_id")},success:function(){$("#js-inline-notification").html("")}})})}))}})}}(),timeshift_media.logged_in&&$.ajax({type:"GET",url:"/functions/ajax/alerts.cfm",data:{action:"recent_alerts"}}).done(function(result){var html;try{if(result.alerts.DATA.length){var new_alert_count=result.alerts.DATA.filter(function(alert){return!0===alert[1]}).length,$alerts_menu=$("#js-notifications-menu");$($alerts_menu).empty(),0<new_alert_count&&(html='<li class="text-right drop-down-menu-notify">',html+='<a style="cursor: pointer;',html+='padding-top: 5px; padding-bottom: 5px;" class="icon" onclick="mark_all_as_viewed()">',html+='<span class="text-muted small text-right"> Mark ',1<new_alert_count&&(html+="all"),html+=" as read</span></a></li>"),$($alerts_menu).html(html),$.each(result.alerts.DATA,function(index,value){html='<li name="alert_item" class="'+(value[1]?"alert-unread":"alert-read")+'">',html=(html=(html+='<a href="/account/notifications/alert_redirect.cfm?customer_alert_id=')+value[0]+'" class="icon" data-customer_alert_id="'+value[0]+' ">')+'<i class="'+value[2]+'"></i> ',html=(html+=value[4])+'<span class="text-muted">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'+value[3]+"</span>",html+="</a></li>",$($alerts_menu).append(html)}),html='<li class="viewallnotifications">',html+='<a href="/account/notifications/my_notifications.cfm">View notification details</a>',html+="</li>",$($alerts_menu).append(html),0<new_alert_count&&($(".js-new-alerts-indicator").html(new_alert_count),$(".js-new-alerts-indicator").addClass("js-alerts-counter badge badge-warning"))}}catch(e){console.log(e)}}),$(".js-gif-play-button").click(function(){img_id=current_src=$(this).attr("data-img-id"),current_src=$(img_id).attr("src"),anim_src=$(this).attr("data-anim-gif-name"),still_src=$(this).attr("data-still-name"),$(this).toggleClass("tm-video-thumbnail tm-video-thumbnail-playing"),current_src==still_src?$(img_id).attr("src",anim_src):$(img_id).attr("src",still_src)}),$(".js-class-modal").click(function(){my_class_id=$(this).attr("data-class-id"),my_map_key="classID_"+my_class_id,thisModalclass=modalClasses.get(my_map_key),$("#js-class-modal-class-name").html(thisModalclass.get("className")),$("#js-class-modal-instructor_names").html(thisModalclass.get("instructorNames")),$("#js-class-modal-duration").html(thisModalclass.get("duration")),$("#js-class-modal-short-description").html(thisModalclass.get("shortDescription")),slideText=thisModalclass.get("modalSlideText"),""!=slideText?($("#js-class-modal-slide_text").html(slideText),$("#js-class-modal-slide_text").show()):$("#js-class-modal-slide_text").hide(),modal_type=thisModalclass.get("modalType"),$("#js-class-modal-cta-full-class").hide(),$("#js-class-modal-cta-preview").hide(),"full_class"==modal_type?$("#js-class-modal-cta-full-class").show():$("#js-class-modal-cta-preview").show(),$("#js-class-modal-image-plcaeholder").hide(),$("#js-class-modal-video-plcaeholder").hide(),"image"==thisModalclass.get("imageOrVideoType")?($("#js-class-modal-image").attr("src",thisModalclass.get("imageUrl")),$("#js-class-modal-image-plcaeholder").show()):($("#js-class-modal-video-plcaeholder").show(),new_playlist={file:thisModalclass.get("commercialVideoURL"),image:thisModalclass.get("commercialVideoThumbnail")},playermediaspaceClassModal.load(new_playlist)),$("#ClassModal").modal()}),$(".js-teacher-modal").click(function(){my_instructor_id=$(this).attr("data-instructor-id"),my_map_key="instructorID_"+my_instructor_id,thisModalteacher=modalTeachers.get(my_map_key),$(".js-teacher-modal-teacher-name").html(thisModalteacher.get("teacherName")),$("#js-teacher-modal-short-description").html(thisModalteacher.get("shortDescription")),$("#js-teacher-modal-image").attr("src",thisModalteacher.get("imageUrl")),$("#TeacherModal").modal()}),$(".js-show-modal").click(function(){my_show_id=$(this).attr("data-show-id"),my_map_key="showID_"+my_show_id,thisModalShow=modalShows.get(my_map_key),$("#js-show-modal-show-name").html(thisModalShow.get("showName")),$("#js-show-modal-season-count").html(thisModalShow.get("seasonCount")),$("#js-show-modal-episode-count").html(thisModalShow.get("episodeCount")),$("#js-show-modal-short-description").html(thisModalShow.get("shortDescription")),season_count=parseInt(thisModalShow.get("seasonCount")),$("#js-show-modeal-season-count-placeholder").hide(),1<season_count&&$("#js-show-modeal-season-count-placeholder").show(),$("#js-show-modal-image-plcaeholder").hide(),$("#js-show-modal-video-plcaeholder").hide(),"image"==thisModalShow.get("imageOrVideoType")?($("#js-show-modal-image").attr("src",thisModalShow.get("imageUrl")),$("#js-show-modal-image-plcaeholder").show()):($("#js-show-modal-video-plcaeholder").show(),new_playlist={file:thisModalShow.get("commercialVideoURL"),image:thisModalShow.get("commercialVideoThumbnail")},playermediaspaceShowModal.load(new_playlist)),$("#ShowModal").modal()}),$(document).ajaxError(function(event,jqxhr,settings){if("ajaxError"===event.type){var responseText=jqxhr.responseText,responseHTML=responseText.substring(responseText.search(/(<html>)/));JSON.stringify({type:event.type,currentTarget:{cookie:event.currentTarget.cookie,domain:event.currentTarget.domain,title:event.currentTarget.title,URL:event.currentTarget.URL},jqxhr:{responseText:responseHTML,status:jqxhr.status,statusText:jqxhr.statusText},settings:{dataType:settings.dataType,type:settings.type,url:settings.url}})}}),$(".js-show-hide").click(function(){this_link=$(this),unqiue_id=this_link.attr("data-unique-id"),short_div_id="#js-summary-div-"+unqiue_id,long_div_id="#js-full-div-"+unqiue_id,arrow_id="#js-arrow-"+unqiue_id,more_text_div_id="#js-more-text-"+unqiue_id,less_text_div_id="#js-less-text-"+unqiue_id,$(arrow_id).toggleClass("fa-chevron-down fa-chevron-up"),$(more_text_div_id).toggleClass("hidden"),$(less_text_div_id).toggleClass("hidden"),$(short_div_id).toggle(),$(long_div_id).toggleClass("hidden"),$(long_div_id).hasClass("hidden")||"promo-code-entry"!=unqiue_id||($("#coupon_code").focus(),$("#js-coupon-code-step-2").focus())}),setCookie=function(name,value,daysToLive){var cookie=name+"="+encodeURIComponent(value);"number"==typeof daysToLive&&(cookie+="; max-age="+24*daysToLive*60*60+";secure",document.cookie=cookie+";path=/")},showVideoCompleteModal=function(){$.ajax({type:"GET",dataType:"json",url:"/classes/ajax/friend_share_ajax.cfm?action=check_remaining",success:function(data){data.ERROR||"0"!=data.SHARES_REMAINING&&($(".js-friend-share-step1").show(),$(".js-friend-share-step2").hide(),$(".js-friend-share-error").hide(),$(".js-friend-share-link").hide(),$(".js-friend-share-thanks").hide(),$("#share_with_friend_modal").modal("show"))},error:function(){}})},markFriendShareComplete=function(friend_share_code){var url="/classes/ajax/friend_share_ajax.cfm?action=mark_complete&sc="+friend_share_code;$.ajax({type:"GET",dataType:"json",url:url,success:function(data){data.ERROR||$("#friend_share_welcome_modal").modal("hide")},error:function(){}})},markFriendSharePlay=function(friend_share_code,vvi){var url="/classes/ajax/friend_share_ajax.cfm?action=mark_played&sc="+friend_share_code+"&vvi="+vvi;$.ajax({type:"GET",dataType:"json",url:url,success:function(data){data.ERROR||$("#friend_share_welcome_modal").modal("hide")},error:function(){}})},$("#js-friend-share-tandcs").click(function(){$("#js-friend-share-terms-error").hide(200)}),$("#js-friend-share-close-button").click(function(){if($("#js-friend-share-terms-error").hide(200),$("#js-friend-share-tandcs").is(":checked")){watch_button=$(this),friend_share_code=watch_button.attr("data-friend-share-code"),$("#js-friend-share-newsok").is(":checked")?my_newsok=1:my_newsok=0;var url="/classes/ajax/friend_share_ajax.cfm?action=agree_terms&sc="+friend_share_code+"&newsok="+my_newsok;$.ajax({type:"GET",dataType:"json",url:url,success:function(data){data.ERROR?($("#js-friend-share-terms-error").html(data.ERROR_MESSAGE),$("#js-friend-share-terms-error").show(200)):$("#friend_share_welcome_modal").modal("hide")},error:function(){}})}else $("#js-friend-share-terms-error").show(200)}),$("#js-friend-share-button-step1").click(function(){$(".js-friend-share-step1").hide(200),$(".js-friend-share-step2").show(200)}),$("#js-friend-share-show-link").click(function(){share_link=$(this),my_class_id=share_link.attr("data-class-id");var url="/classes/ajax/friend_share_ajax.cfm?action=generate_link&my_class_id="+my_class_id;$.ajax({type:"GET",dataType:"json",url:url,success:function(data){data.ERROR?($("#js-friend-share-error-message").html(data.ERROR_MESSAGE),$(".js-friend-share-step2").hide(200),$(".js-friend-share-error").show(200)):($("#js-share-link").val(data.SHARE_LINK),$("#js-friend-share-email-link").attr("href",data.mailto_link),$("#js-shares-remaining").html(data.SHARES_REMAINING),"0"==data.SHARES_REMAINING&&$(".js-share-again-link").hide(),$(".js-friend-share-step2").hide(200),$(".js-friend-share-link").show(200))},error:function(){}})}),$("#js-friend-share-copy-link").click(function(){$("#js-share-link").select(),document.execCommand("copy"),$("#js-copy-message").show(200)}),$(".js-share-again-link").click(function(){$(".js-friend-share-thanks").hide(),$(".js-friend-share-link").hide(),$(".js-friend-share-step2").show(200)});var frm=$("#js-friend-email-form");frm.submit(function(e){$("#js-friend-share-form-error-message").hide(),e.preventDefault(),$.ajax({type:frm.attr("method"),url:frm.attr("action"),data:frm.serialize(),success:function(data){data.ERROR?($("#js-friend-share-form-error-message").html(data.ERROR_MESSAGE),$("#js-friend-share-form-error-message").show(200)):($("#js-friend-name").val(""),$("#js-friend-email").val(""),$(".js-friend-share-step2").hide(200),$(".js-friend-share-thanks").show(200))},error:function(){}})}),$(".js-live-cast-signup-button").click(function(){lcid=$(this).attr("data-lcid"),$("#js-live-cast-cancelled-message-"+lcid).hide(),$("#js-sign-up-thinking-"+lcid).show(),$("#js-sign-up-button-"+lcid).hide();var url="/live-ajax/sign_up/"+lcid+"/0";$.ajax({type:"GET",dataType:"json",url:url,success:function(data){data.ERROR?($("#js-sign-up-thinking-"+lcid).hide(),$("#js-sign-up-button-"+lcid).show(),alert(data.ERROR_MESSAGE)):($("#js-sign-up-thinking-"+lcid).hide(),$("#js-signed-up-"+lcid).show(200))},error:function(){}})}),$("#js-live-cast-season-signup-button").click(function(){my_button=$(this),pid=my_button.attr("data-pid"),lcid=my_button.attr("data-lcid"),$("#js-season-sign-up-thinking").show(),$("#js-sign-up-thinking-"+lcid).show(),$("#js-sign-up-button-"+lcid).hide(),$("#js-live-cast-season-signup-button").hide(),$("#js-live-cast-cancelled-message-"+lcid).hide(200);var url="/live-ajax/season_sign_up/"+pid+"/"+lcid;$.ajax({type:"GET",dataType:"json",url:url,success:function(data){data.ERROR?($("#js-season-sign-up-thinking").hide(),$("#js-sign-up-button-"+lcid).show(),$("#js-live-cast-season-signup-button").show(),alert(data.ERROR_MESSAGE)):($("#js-season-sign-up-thinking").hide(),$("#js-season-signed-up").show(200),$("#js-live-cast-season-signup-button").hide(),$(".js-sign-up-button-pid-"+pid).hide(),$(".js-live-cast-cancelled-message-pid-"+pid).hide(),$(".js-signed-up-pid-"+pid).show(),$("#js-sign-up-thinking-"+lcid).hide(),$("#js-sign-up-button-"+lcid).hide(),$("#js-signed-up-"+lcid).show(200))},error:function(){}})}),$(".js-live-cast-cancel-button").click(function(){lcid=$(this).attr("data-lcid"),$("#js-sign-up-thinking-"+lcid).show(),$("#js-signed-up-"+lcid).hide();var url="/live-ajax/cancel/"+lcid+"/0";$.ajax({type:"GET",dataType:"json",url:url,success:function(data){data.ERROR?($("#js-sign-up-thinking-"+lcid).hide(),$("#js-signed-up-"+lcid).show(),alert(data.ERROR_MESSAGE)):($("#js-live-cast-cancelled-message-"+lcid).show(200),$("#js-sign-up-thinking-"+lcid).hide(),$("#js-sign-up-button-"+lcid).show())},error:function(){}})}),$(".js-live-cast-season-cancel-button").click(function(){my_button=$(this),lcid=my_button.attr("data-lcid"),pid=my_button.attr("data-pid"),$("#js-sign-up-thinking-"+lcid).show(),$("#js-signed-up-"+lcid).hide();var url="/live-ajax/cancel_season/"+pid+"/"+lcid;$.ajax({type:"GET",dataType:"json",url:url,success:function(data){data.ERROR?($("#js-sign-up-thinking-"+lcid).hide(),$("#js-signed-up-"+lcid).show(),alert(data.ERROR_MESSAGE)):($("#js-live-cast-cancelled-message-"+lcid).show(200),$("#js-sign-up-thinking-"+lcid).hide(),$("#js-sign-up-button-"+lcid).show(),$(".js-signed-up-pid-"+pid).hide(200))},error:function(){}})}),Object.keys(timeshift_media.class_thumbnails).length&&$.getJSON("/classes/class_customization_json.cfm",{action:"viewed_classes",class_ids:Object.keys(timeshift_media.class_thumbnails).join()},function(json_data){$.each(json_data,function(index){$('.js-eyeball[data-class_id="'+index+'"]').show()})});